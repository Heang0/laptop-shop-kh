<ion-content fullscreen="true" class="cart">
  <div class="topbar">
    <h2 class="title">Shopping Cart</h2>
    <button class="clear-btn" *ngIf="cartItems.length > 0" (click)="clearCart()" aria-label="Clear cart">
      Clear All
    </button>
  </div>

  <div class="content" *ngIf="cartItems.length > 0; else emptyState">
    <div class="cart-list">
      <div class="cart-item" *ngFor="let item of cartItems" [routerLink]="['/product', item.product.id]">
        <div class="item-img">
          <img [src]="item.product.img" [alt]="item.product.name" loading="lazy" appFallbackImg="assets/img/galaxy-book.svg" />
        </div>

        <div class="item-info">
          <div class="item-name">{{ item.product.name }}</div>
          <div class="item-brand">{{ item.product.brand }}</div>
          <div class="item-price">{{ item.product.price | currency:'USD':'symbol':'1.0-0' }}</div>
        </div>

        <div class="item-actions">
          <div class="quantity-control">
            <button class="qty-btn" (click)="updateQuantity(item, -1); $event.stopPropagation()" aria-label="Decrease quantity">
              <ion-icon name="remove-outline"></ion-icon>
            </button>
            <span class="qty-value">{{ item.quantity }}</span>
            <button class="qty-btn" (click)="updateQuantity(item, 1); $event.stopPropagation()" aria-label="Increase quantity">
              <ion-icon name="add-outline"></ion-icon>
            </button>
          </div>
          <button class="remove-btn" (click)="removeItem(item.product.id); $event.stopPropagation()" aria-label="Remove item">
            <ion-icon name="trash-outline"></ion-icon>
          </button>
        </div>
      </div>
    </div>

    <div class="cart-footer">
      <div class="total-section">
        <div class="total-label">Total</div>
        <div class="total-amount">{{ getTotal() | currency:'USD':'symbol':'1.0-0' }}</div>
      </div>
      <button class="checkout-btn" routerLink="/checkout">Checkout</button>
    </div>
  </div>

  <ng-template #emptyState>
    <div class="empty-state">
      <ion-icon name="bag-outline"></ion-icon>
      <h2>Your Cart is Empty</h2>
      <p>Start adding products to your cart!</p>
    </div>
  </ng-template>

  <div class="bottom-safe"></div>
</ion-content>
